package edu.kit.ipd.sdq.kamp4attack.tests.change.vulnerability.scalability;

import org.palladiosimulator.pcm.confidentiality.attackerSpecification.pcmIntegration.PcmIntegrationFactory;
import org.palladiosimulator.pcm.confidentiality.attackerSpecification.pcmIntegration.VulnerabilitySystemIntegration;
import org.palladiosimulator.pcm.resourceenvironment.ResourceContainer;
import org.palladiosimulator.pcm.resourceenvironment.ResourceEnvironment;
import org.palladiosimulator.pcm.resourceenvironment.ResourceenvironmentFactory;

public class ChainedResourcesTests extends ScalabilityTests {




    @Override
    protected String getFilename() {
        return "chain.csv";
    }

    @Override
    protected ResourceContainer resourceAddOperation(ResourceEnvironment environment, ResourceContainer origin,
            VulnerabilitySystemIntegration integration) {
        var resource = ResourceenvironmentFactory.eINSTANCE.createResourceContainer();
        var linking = ResourceenvironmentFactory.eINSTANCE.createLinkingResource();

        linking.getConnectedResourceContainers_LinkingResource().add(origin);
        linking.getConnectedResourceContainers_LinkingResource().add(resource);

        var pcmElement = PcmIntegrationFactory.eINSTANCE.createPCMElement();
        pcmElement.setResourcecontainer(resource);
        integration.setPcmelement(pcmElement);

        environment.getLinkingResources__ResourceEnvironment().add(linking);
        environment.getResourceContainer_ResourceEnvironment().add(resource);

        return resource;
    }
}
